// (FSRCNNX_x2_8-0-4-1) sub-pixel convolution 1


cbuffer constants : register(b0) {
	int2 srcSize : packoffset(c0.x);
};


#define MAGPIE_INPUT_COUNT 2
#include "common.hlsli"

#define get0(pos) uncompressLinear(SampleInput(0, pos), -1.5, 2)
#define get1(pos) uncompressLinear(SampleInput(1, pos), -1, 4)


D2D_PS_ENTRY(main) {
	InitMagpieSampleInput();

	float2 leftTop = GetCheckedOffPos(0, float2(-1, -1));
	float2 rightBottom = GetCheckedOffPos(0, float2(1, 1));

	float4 res = { 0.2010385394096375,0.2058132737874985,0.1918809115886688,0.1961363703012466 };
	res += mul(get0(leftTop), float4x4(-0.0005980331334285, -0.0095877395942807, -0.0149448839947581, -0.0026380482595414, 0.0320665836334229, -0.0706205591559410, -0.0054677254520357, 0.0215112231671810, -0.0025710910558701, -0.0000433265340689, 0.0044494951143861, -0.0034823501482606, -0.0050858515314758, 0.0109513988718390, 0.0208286065608263, -0.0032168829347938));
	res += mul(get1(leftTop), float4x4(-0.0145305208861828, 0.0246876608580351, -0.0038286084309220, -0.0033089490607381, -0.0920709222555161, -0.0767898634076118, 0.0012083095498383, -0.0751532614231110, 0.0001302754972130, -0.0107085108757019, -0.0010383903281763, -0.0059571005403996, 0.0809685289859772, 0.0414833538234234, 0.0227938480675220, -0.0211347509175539));
	res += mul(get0(float2(leftTop.x, Coord(0).y)), float4x4(0.0160999298095703, 0.0364215746521950, -0.0377063788473606, -0.0449111759662628, -0.0476365163922310, 0.1522845029830933, -0.0131391752511263, -0.0476671792566776, -0.0378389135003090, 0.0235454943031073, 0.0224007442593575, -0.0010372076649219, -0.0089435689151287, -0.0293026417493820, 0.0274190884083509, 0.0469092652201653));
	res += mul(get1(float2(leftTop.x, Coord(0).y)), float4x4(0.0297575183212757, -0.0132508194074035, -0.0044682323932648, -0.0096222748979926, 0.2525918781757355, 0.1873829364776611, -0.5599535703659058, -0.2372044622898102, 0.0033207221422344, 0.0256173480302095, 0.0294605866074562, 0.0323960892856121, -0.1679904460906982, -0.1278967708349228, 0.3168168365955353, 0.1978507637977600));
	res += mul(get0(float2(leftTop.x, rightBottom.y)), float4x4(-0.0047590560279787, -0.0149335600435734, 0.0033453819341958, -0.0012247267877683, 0.1112466752529144, 0.0147760482504964, 0.0031189601868391, 0.0391573049128056, -0.0028154491446912, -0.0036881719715893, -0.0116015253588557, -0.0037573333829641, 0.0047581391409039, 0.0071071563288569, -0.0033221673220396, 0.0004882142529823));
	res += mul(get1(float2(leftTop.x, rightBottom.y)), float4x4(-0.0025197160430253, -0.0018677815096453, 0.0038254233077168, 0.0041981274262071, -0.1321131736040115, -0.0494364202022552, 0.0760654658079147, -0.1386690139770508, -0.0016222692793235, -0.0060105528682470, 0.0010201989207417, 0.0092753591015935, -0.0194614846259356, 0.0087382243946195, -0.0606758072972298, 0.0156162241473794));
	res += mul(get0(float2(Coord(0).x, leftTop.y)), float4x4(-0.0073722628876567, 0.0012844242155552, 0.0241398401558399, -0.0075527969747782, -0.0865194946527481, -0.0610522404313087, 0.0289319511502981, -0.0994452014565468, 0.0281447004526854, -0.0250582899898291, 0.0044891634024680, -0.0246205236762762, 0.0112307453528047, -0.0010844616917893, -0.0223584957420826, 0.0177635718137026));
	res += mul(get1(float2(Coord(0).x, leftTop.y)), float4x4(-0.0585863515734673, 0.0953190475702286, -0.0555586628615856, 0.1033507287502289, 0.1560877263545990, -0.0690897777676582, -0.0341389514505863, -0.0661668032407761, 0.0531073249876499, -0.0266165956854820, -0.0203275382518768, 0.0017760475166142, -0.1300747394561768, 0.1810652017593384, 0.0381597876548767, 0.1397419273853302));
	res += mul(get0(Coord(0).xy), float4x4(0.6259804368019104, 0.6062518954277039, 0.5450409054756165, 0.5966195464134216, -0.0423948727548122, 0.0760537460446358, -0.0113651463761926, 0.3007817566394806, -0.3218322694301605, 0.2713021934032440, -0.3143473267555237, 0.2303840517997742, 0.3493050038814545, 0.3590726852416992, 0.4138027429580688, 0.3391666412353516));
	res += mul(get1(Coord(0).xy), float4x4(0.0790478289127350, -0.0978994593024254, 0.0779844969511032, -0.0823706611990929, 0.0094470111653209, 0.1671760678291321, 0.1201528310775757, -0.2016288936138153, 0.3667598366737366, 0.3651430010795593, -0.3612343966960907, -0.2978236973285675, -0.4231655597686768, 0.0091423410922289, -0.1918412446975708, 0.4224558770656586));
	res += mul(get0(float2(Coord(0).x, rightBottom.y)), float4x4(-0.0186564289033413, 0.0274957418441772, -0.0064405309967697, 0.0056951809674501, 0.4864942431449890, -0.2563461959362030, 0.4357284605503082, -0.2976118028163910, 0.0374982468783855, 0.0167757049202919, 0.0305800959467888, 0.0232830215245485, 0.0138373551890254, -0.0191283021122217, 0.0032355054281652, 0.0055057541467249));
	res += mul(get1(float2(Coord(0).x, rightBottom.y)), float4x4(-0.0276355985552073, 0.0048149987123907, -0.0251619722694159, -0.0057246969081461, 0.0271473955363035, -0.0042668608948588, -0.0594691745936871, 0.2255926281213760, -0.0203660242259502, 0.0721646770834923, 0.0137230781838298, -0.0650938376784325, -0.3049557507038116, 0.2035628110170364, -0.2509683668613434, 0.1962853819131851));
	res += mul(get0(float2(rightBottom.x, leftTop.y)), float4x4(0.0109980758279562, -0.0053752651438117, -0.0112550277262926, 0.0024017230607569, 0.0362104885280132, 0.0084348218515515, -0.0106990104541183, -0.0207723993808031, -0.0014961160486564, 0.0066790678538382, 0.0028113177977502, 0.0025022011250257, -0.0093937022611499, 0.0016421369509771, 0.0035362334456295, -0.0058064293116331));
	res += mul(get1(float2(rightBottom.x, leftTop.y)), float4x4(0.0138889988884330, -0.0078343702480197, 0.0061464929021895, 0.0202130675315857, -0.0257590841501951, -0.0366640128195286, 0.0250097587704659, -0.0498071312904358, -0.0103149358183146, -0.0001786737266229, -0.0099909817799926, 0.0062733208760619, 0.0131437368690968, -0.0005469865864143, -0.0388854071497917, 0.0612070746719837));
	res += mul(get0(float2(rightBottom.x, Coord(0).y)), float4x4(0.0052813654765487, 0.0215748809278011, 0.0107395220547915, -0.0079439217224717, 0.0382786765694618, 0.0697424262762070, -0.0415962152183056, 0.0657853558659554, 0.0209470037370920, -0.0218399092555046, -0.0447359494864941, 0.0407319553196430, -0.0040902681648731, -0.0196106657385826, -0.0018554026028141, 0.0203906055539846));
	res += mul(get1(float2(rightBottom.x, Coord(0).y)), float4x4(-0.0106181986629963, 0.0084018819034100, 0.0131329754367471, -0.0198754761368036, 0.1117177084088326, 0.0990846082568169, -0.0732304081320763, 0.0163581725209951, -0.0648830309510231, -0.0451613292098045, 0.0206844564527273, 0.0031441387254745, -0.0106161693111062, -0.0567689687013626, 0.0782861113548279, -0.0306094046682119));
	res += mul(get0(rightBottom), float4x4(0.0012452082009986, -0.0026056850329041, -0.0096226977184415, -0.0037850935477763, -0.0190967041999102, 0.0534373670816422, 0.1599360853433609, 0.0834670960903168, -0.0070255175232887, 0.0012873009545729, 0.0030876772943884, -0.0093916896730661, -0.0033529615029693, 0.0043485122732818, 0.0089034689590335, -0.0067489291541278));
	res += mul(get1(rightBottom), float4x4(0.0004713654634543, -0.0034161377698183, -0.0026913962792605, 0.0053522582165897, -0.0040974905714393, 0.0273330621421337, -0.0333138220012188, -0.0701237097382545, 0.0082997502759099, -0.0183656588196754, -0.0122841577976942, -0.0052855615504086, -0.0023795007728040, -0.0438593104481697, -0.1101513057947159, -0.0182559806853533));
	return res;
}
